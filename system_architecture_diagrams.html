<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Moderation Engine - System Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .diagram-section {
            padding: 40px;
            border-bottom: 2px solid #f0f0f0;
        }
        .diagram-section:last-child {
            border-bottom: none;
        }
        h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        h2 {
            color: #667eea;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h3 {
            color: #764ba2;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        .diagram-container {
            background: #fafafa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #e0e0e0;
        }
        .description {
            background: #f8f9ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .metric-card {
            background: #fff;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        .metric-label {
            color: #666;
            margin-top: 5px;
        }
        .toc {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .toc ul {
            list-style: none;
            padding: 0;
        }
        .toc li {
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        .toc a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }
        .toc a:hover {
            color: #764ba2;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ›¡ï¸ Content Moderation Engine</h1>
            <p>Ultra-Detailed System Architecture & Workflow Analysis</p>
        </div>

        <div class="diagram-section">
            <div class="toc">
                <h3>ğŸ“‹ Table of Contents</h3>
                <ul>
                    <li><a href="#overview">1. System Overview</a></li>
                    <li><a href="#frontend">2. Frontend Layer Detailed</a></li>
                    <li><a href="#api">3. API Layer Detailed</a></li>
                    <li><a href="#pipeline">4. Moderation Pipeline Deep Dive</a></li>
                    <li><a href="#rule-based">5. Rule-Based Filter Detail</a></li>
                    <li><a href="#ai-processing">6. AI Processing Pipeline</a></li>
                    <li><a href="#database">7. Database Operations</a></li>
                    <li><a href="#error-handling">8. Error Handling & Edge Cases</a></li>
                    <li><a href="#performance">9. Performance Metrics</a></li>
                </ul>
            </div>
        </div>

        <div class="diagram-section" id="overview">
            <h2>1. ğŸŒ Complete System Overview</h2>
            <div class="description">
                <strong>High-Level Architecture:</strong> This diagram shows the complete end-to-end flow from user input to final response, including all major components and decision points.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A["ğŸŒ User Browser<br/>Chrome/Firefox/Safari"] --> B["ğŸ“± Frontend Interface<br/>index.html"]
    B --> C["ğŸ“ Content Input<br/>Textarea Element<br/>Max 300 chars"]
    C --> D["ğŸ”„ Client-Side Validation<br/>Empty check<br/>Content trimming"]
    D --> E["ğŸš€ AJAX Request<br/>POST /moderate<br/>Content-Type: application/json"]
    
    E --> F["ğŸ”— FastAPI Server<br/>Port 8000<br/>CORS Enabled"]
    F --> G["ğŸ“¥ Request Processing<br/>Pydantic Validation<br/>ModerationRequest"]
    G --> H["ğŸ¯ Main Pipeline<br/>moderate_content()"]
    
    H --> I["ğŸ” STAGE 1<br/>Rule-Based Filter<br/>2725+ Keywords"]
    I -->|Pass| J["ğŸ¤– STAGE 2<br/>Detoxify AI<br/>unitary/toxic-bert"]
    J -->|Pass| K["ğŸ’° STAGE 3<br/>FinBERT AI<br/>ProsusAI/finbert"]
    
    I -->|Fail| L["âŒ IMMEDIATE REJECT<br/>Rule Violation"]
    J -->|Fail| M["âŒ TOXICITY DETECTED<br/>Score > 0.5"]
    K -->|Fail| N["âŒ FINANCIAL RISK<br/>Negative > 0.7"]
    K -->|Pass| O["âœ… ALL CHECKS PASSED<br/>Content Approved"]
    
    L --> P["ğŸ’¾ Database Insert<br/>SQLite - posts table"]
    M --> P
    N --> P
    O --> P
    
    P --> Q["ğŸ“¤ API Response<br/>ModerationResponse<br/>{accepted, reason, id}"]
    Q --> R["ğŸ¨ Frontend Update<br/>Show Result<br/>Green/Red Status"]
    R --> S["ğŸ“Š Auto Refresh<br/>Posts Table<br/>GET /posts"]
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style H fill:#fff3e0
    style I fill:#e8f5e8
    style J fill:#fce4ec
    style K fill:#f1f8e9
    style P fill:#e0f2f1
                </div>
            </div>
        </div>

        <div class="diagram-section" id="frontend">
            <h2>2. ğŸ“± Frontend Layer Detailed</h2>
            <div class="description">
                <strong>Frontend Components:</strong> Detailed breakdown of the user interface components and their interactions.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
graph LR
    A["ğŸŒ index.html<br/>Main Interface"] --> B["ğŸ“ Content Form<br/>ID: content<br/>Max Length: 300"]
    A --> C["ğŸ¨ CSS Styling<br/>Responsive Design<br/>Color Coding"]
    A --> D["âš¡ JavaScript Logic<br/>API Integration"]
    
    B --> E["ğŸ”² Submit Button<br/>onclick: moderateContent()"]
    E --> F["âœ… Validation<br/>Trim whitespace<br/>Check empty"]
    
    F --> G["ğŸ”„ Loading State<br/>Disable button<br/>Show spinner"]
    G --> H["ğŸ“¡ Fetch API<br/>POST request<br/>JSON payload"]
    
    H --> I["ğŸ“¥ Response Handler<br/>Success/Error"]
    I --> J["ğŸ¯ showResult()<br/>Update UI elements"]
    J --> K["ğŸŸ¢ Success Display<br/>Green background<br/>âœ… ACCEPTED"]
    J --> L["ğŸ”´ Rejection Display<br/>Red background<br/>âŒ REJECTED"]
    
    I --> M["ğŸ“Š loadPosts()<br/>Refresh table"]
    M --> N["ğŸ“‹ Posts Table<br/>Recent submissions<br/>Pagination"]
    
    I --> O["âŒ showError()<br/>Error handling"]
    O --> P["ğŸš¨ Error Message<br/>Connection issues<br/>Server errors"]
    
    style A fill:#e1f5fe
    style D fill:#f3e5f5
    style H fill:#fff3e0
    style J fill:#e8f5e8
                </div>
            </div>
        </div>

        <div class="diagram-section" id="api">
            <h2>3. ğŸ”— API Layer Detailed</h2>
            <div class="description">
                <strong>FastAPI Backend:</strong> Complete API endpoint structure and middleware stack.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A["ğŸŒ HTTP Request<br/>Client Browser"] --> B["ğŸ”— CORS Middleware<br/>Allow Origins: *<br/>Methods: *<br/>Headers: *"]
    B --> C["ğŸ¯ FastAPI Router<br/>Endpoint Matching"]
    
    C --> D["ğŸ“ GET /<br/>Root endpoint<br/>Health status"]
    C --> E["ğŸ“ GET /health<br/>System health<br/>{'status': 'healthy'}"]
    C --> F["ğŸ“ POST /moderate<br/>Main moderation<br/>Content processing"]
    C --> G["ğŸ“ GET /posts<br/>Retrieve posts<br/>Database query"]
    
    F --> H["ğŸ“¥ Request Validation<br/>Pydantic Models<br/>ModerationRequest"]
    H --> I["ğŸ” Content Extraction<br/>request.content<br/>String processing"]
    I --> J["ğŸ¯ Pipeline Execution<br/>moderate_content()"]
    
    J --> K["ğŸ’¾ Database Session<br/>SQLAlchemy<br/>SessionLocal()"]
    K --> L["ğŸ“Š Post Creation<br/>Post model<br/>ORM mapping"]
    L --> M["ğŸ’¿ Commit Transaction<br/>Database write<br/>Auto-increment ID"]
    
    M --> N["ğŸ“¤ Response Creation<br/>ModerationResponse<br/>Pydantic serialization"]
    N --> O["ğŸ”„ JSON Response<br/>HTTP 200<br/>Content-Type: json"]
    
    G --> P["ğŸ“‹ Query All Posts<br/>ORDER BY created_at DESC"]
    P --> Q["ğŸ“Š List Serialization<br/>Convert to dict<br/>ISO datetime"]
    
    H --> R["âŒ Validation Error<br/>HTTP 422<br/>Pydantic errors"]
    J --> S["âŒ Processing Error<br/>HTTP 500<br/>Exception handling"]
    
    style A fill:#e3f2fd
    style B fill:#fff3e0
    style F fill:#e8f5e8
    style J fill:#fce4ec
    style K fill:#f1f8e9
                </div>
            </div>
        </div>

        <div class="diagram-section" id="pipeline">
            <h2>4. ğŸ›¡ï¸ Moderation Pipeline Deep Dive</h2>
            <div class="description">
                <strong>Three-Stage Sequential Processing:</strong> Each stage can independently reject content. Only content passing all stages is accepted.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A["ğŸ“¥ Input Content<br/>Raw text string"] --> B["ğŸ” STAGE 1: Rule-Based<br/>rule_based_filter()"]
    
    B --> C{"ğŸ” Keyword Check<br/>2725+ words<br/>Case insensitive"}
    C -->|Match Found| D["âŒ REJECT<br/>Rule-based: {keyword}"]
    C -->|No Match| E{"ğŸ“ Regex Patterns<br/>URLs, emails, phones<br/>Violence keywords"}
    E -->|Match Found| F["âŒ REJECT<br/>Rule-based: {pattern}"]
    E -->|No Match| G["âœ… Stage 1 PASS<br/>Continue to Stage 2"]
    
    G --> H["ğŸ¤– STAGE 2: Detoxify<br/>detoxify_check()"]
    H --> I{"ğŸ§  AI Model Check<br/>toxic-bert<br/>Context analysis"}
    I -->|Loading Error| J["âš ï¸ Model Fallback<br/>Continue processing"]
    I -->|Score > 0.5| K["âŒ REJECT<br/>Toxic (Detoxify): {score}"]
    I -->|Score â‰¤ 0.5| L["âœ… Stage 2 PASS<br/>Continue to Stage 3"]
    
    L --> M["ğŸ’° STAGE 3: FinBERT<br/>finbert_check()"]
    M --> N{"ğŸ’¼ Financial Analysis<br/>ProsusAI/finbert<br/>Sentiment detection"}
    N -->|Loading Error| O["âš ï¸ Model Fallback<br/>Continue processing"]
    N -->|Negative > 0.7| P["âŒ REJECT<br/>Potential Fraud (FinBERT)"]
    N -->|Negative â‰¤ 0.7| Q["âœ… Stage 3 PASS<br/>All checks passed"]
    
    D --> R["ğŸ“Š Final Result<br/>accepted: false<br/>reason: Rule violation"]
    F --> R
    K --> R
    P --> R
    Q --> S["ğŸ“Š Final Result<br/>accepted: true<br/>reason: All checks passed"]
    
    style A fill:#e3f2fd
    style B fill:#fff3e0
    style H fill:#e8f5e8
    style M fill:#fce4ec
    style R fill:#ffebee
    style S fill:#e8f5e8
                </div>
            </div>
        </div>

        <div class="diagram-section" id="rule-based">
            <h2>5. ğŸ” Rule-Based Filter Detail</h2>
            <div class="description">
                <strong>Stage 1 Processing:</strong> Comprehensive keyword and pattern matching using 2725+ inappropriate terms and regex patterns.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A["ğŸ“¥ Text Input<br/>User content"] --> B["ğŸ“‚ Load Keywords<br/>words.json<br/>2725 terms"]
    B --> C["ğŸ”„ Text Preprocessing<br/>Convert to lowercase<br/>Normalize whitespace"]
    
    C --> D["ğŸ” Keyword Scanning<br/>Whole word matching<br/>\\b{keyword}\\b regex"]
    D --> E{"ğŸ“ Word by Word<br/>Iterate through<br/>2725 keywords"}
    E -->|Match| F["âŒ IMMEDIATE REJECT<br/>Return: Rule-based: {keyword}"]
    E -->|No Match| G["ğŸ“‹ Regex Pattern Check<br/>Pre-defined patterns"]
    
    G --> H["ğŸŒ URL Pattern<br/>http[s]://... detection"]
    G --> I["ğŸ“§ Email Pattern<br/>username@domain.com"]
    G --> J["ğŸ“ Phone Pattern<br/>\\d{10,} detection"]
    G --> K["âš”ï¸ Violence Pattern<br/>kill|hack|steal|threat..."]
    
    H -->|Match| L["âŒ REJECT: URL<br/>Spam/Phishing risk"]
    I -->|Match| M["âŒ REJECT: Email<br/>Contact harvesting"]
    J -->|Match| N["âŒ REJECT: Phone<br/>Spam/Solicitation"]
    K -->|Match| O["âŒ REJECT: Violence<br/>Threat detection"]
    
    H -->|No Match| P["âœ… All Patterns Clear<br/>Continue processing"]
    I -->|No Match| P
    J -->|No Match| P
    K -->|No Match| P
    
    P --> Q["âœ… STAGE 1 COMPLETE<br/>return (True, '')"]
    
    style A fill:#e3f2fd
    style B fill:#fff3e0
    style D fill:#e8f5e8
    style G fill:#f3e5f5
    style Q fill:#e8f5e8
                </div>
            </div>
            
            <div class="metrics">
                <div class="metric-card">
                    <div class="metric-value">2,725</div>
                    <div class="metric-label">Keywords Loaded</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">4</div>
                    <div class="metric-label">Regex Patterns</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">&lt;50ms</div>
                    <div class="metric-label">Processing Time</div>
                </div>
            </div>
        </div>

        <div class="diagram-section" id="ai-processing">
            <h2>6. ğŸ¤– AI Processing Pipeline</h2>
            <div class="description">
                <strong>Stages 2 & 3:</strong> Sequential AI model processing with Detoxify and FinBERT for context-aware content analysis.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A["ğŸ“¥ Stage 1 Output<br/>Clean text input"] --> B["ğŸ¤– DETOXIFY PROCESSING<br/>unitary/toxic-bert"]
    
    B --> C{"ğŸ” Model Available?<br/>toxicity_classifier"}
    C -->|No| D["âš ï¸ Model Fallback<br/>return (True, '')"]
    C -->|Yes| E["ğŸ§  Transformers Pipeline<br/>Text classification"]
    
    E --> F["ğŸ“Š Process Text<br/>Tokenization<br/>BERT encoding"]
    F --> G["ğŸ¯ Classification<br/>Get label & score"]
    G --> H{"ğŸ“ˆ Score Analysis<br/>result[0]['score']"}
    
    H -->|Score > 0.5| I["âŒ TOXIC DETECTED<br/>Reject with confidence"]
    H -->|Score â‰¤ 0.5| J["âœ… DETOXIFY PASS<br/>Continue to FinBERT"]
    
    J --> K["ğŸ’° FINBERT PROCESSING<br/>ProsusAI/finbert"]
    K --> L{"ğŸ” Model Available?<br/>finbert_classifier"}
    L -->|No| M["âš ï¸ Model Fallback<br/>return (True, '')"]
    L -->|Yes| N["ğŸ’¼ Financial Analysis<br/>Sentiment classification"]
    
    N --> O["ğŸ“Š Process Content<br/>Financial context<br/>Sentiment scoring"]
    O --> P["ğŸ¯ Sentiment Result<br/>positive/negative/neutral"]
    P --> Q{"ğŸ“ˆ Confidence Check<br/>confidence > 0.7"}
    
    Q -->|Negative & High Conf| R["âŒ FINANCIAL RISK<br/>Potential fraud/scam"]
    Q -->|Safe| S["âœ… FINBERT PASS<br/>All checks complete"]
    
    D --> T["ğŸ”„ Continue Pipeline<br/>No AI rejection"]
    I --> U["ğŸ“Š Return Result<br/>Toxic (Detoxify): {score}"]
    R --> V["ğŸ“Š Return Result<br/>Potential Fraud (FinBERT)"]
    S --> W["ğŸ“Š Return Result<br/>All checks passed"]
    M --> T
    
    style A fill:#e3f2fd
    style B fill:#e8f5e8
    style K fill:#fce4ec
    style E fill:#fff3e0
    style N fill:#f1f8e9
                </div>
            </div>
            
            <div class="metrics">
                <div class="metric-card">
                    <div class="metric-value">2-3s</div>
                    <div class="metric-label">Detoxify Time</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">1-2s</div>
                    <div class="metric-label">FinBERT Time</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">0.5</div>
                    <div class="metric-label">Toxicity Threshold</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">0.7</div>
                    <div class="metric-label">Financial Risk Threshold</div>
                </div>
            </div>
        </div>

        <div class="diagram-section" id="database">
            <h2>7. ğŸ’¾ Database Operations</h2>
            <div class="description">
                <strong>SQLite Data Management:</strong> Complete data flow for storing and retrieving moderation results.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A["ğŸ“Š Moderation Result<br/>accepted: bool<br/>reason: string"] --> B["ğŸ”— Database Connection<br/>SQLAlchemy Session"]
    B --> C["ğŸ“ Post Model Creation<br/>ORM Object"]
    
    C --> D["ğŸ“‹ Set Attributes<br/>content: request.content<br/>accepted: result.accepted<br/>reason: result.reason"]
    D --> E["â° Auto Timestamp<br/>created_at: datetime.utcnow()"]
    E --> F["ğŸ’¾ Session Add<br/>db.add(post)"]
    
    F --> G["ğŸ’¿ Commit Transaction<br/>db.commit()"]
    G --> H{"âœ… Success?<br/>No exceptions"}
    H -->|Yes| I["ğŸ”„ Refresh Object<br/>db.refresh(post)<br/>Get auto-generated ID"]
    H -->|No| J["âŒ Rollback<br/>db.rollback()<br/>Raise HTTPException"]
    
    I --> K["ğŸ“¤ Return Post ID<br/>post.id"]
    K --> L["ğŸ”„ Close Session<br/>db.close()"]
    
    M["ğŸ“‹ GET /posts Request"] --> N["ğŸ”— New Session<br/>SessionLocal()"]
    N --> O["ğŸ“Š Query Posts<br/>db.query(Post)"]
    O --> P["ğŸ“… Order By Date<br/>ORDER BY created_at DESC"]
    P --> Q["ğŸ“‹ Fetch All<br/>.all()"]
    Q --> R["ğŸ”„ Convert to Dict<br/>List comprehension"]
    R --> S["ğŸ“… Format Dates<br/>.isoformat()"]
    S --> T["ğŸ”„ Close Session<br/>db.close()"]
    T --> U["ğŸ“¤ Return JSON<br/>Posts array"]
    
    style A fill:#e3f2fd
    style B fill:#fff3e0
    style G fill:#e8f5e8
    style I fill:#f1f8e9
    style M fill:#f3e5f5
                </div>
            </div>
        </div>

        <div class="diagram-section" id="error-handling">
            <h2>8. âŒ Error Handling & Edge Cases</h2>
            <div class="description">
                <strong>Comprehensive Error Management:</strong> How the system handles various failure scenarios and edge cases.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
graph TD
    A["ğŸ”„ Request Processing"] --> B{"ğŸ“ Input Validation<br/>Pydantic Check"}
    B -->|Invalid| C["âŒ HTTP 422<br/>Validation Error<br/>Field details"]
    B -->|Valid| D["ğŸ¯ Pipeline Start"]
    
    D --> E{"ğŸ“‚ words.json Load<br/>File accessibility"}
    E -->|Missing| F["âš ï¸ Fallback Keywords<br/>Default word list<br/>Continue processing"]
    E -->|JSON Error| G["âš ï¸ Parse Error<br/>Log warning<br/>Use defaults"]
    E -->|Success| H["âœ… Keywords Loaded<br/>Continue normally"]
    
    F --> I["ğŸ”„ Continue Pipeline"]
    G --> I
    H --> I
    
    I --> J{"ğŸ¤– AI Model Loading<br/>Transformers check"}
    J -->|Detoxify Error| K["âš ï¸ Skip Detoxify<br/>Log error<br/>return (True, '')"]
    J -->|FinBERT Error| L["âš ï¸ Skip FinBERT<br/>Log error<br/>return (True, '')"]
    J -->|Success| M["âœ… AI Processing<br/>Normal execution"]
    
    K --> N["ğŸ”„ Continue Pipeline<br/>Reduced accuracy"]
    L --> N
    M --> O["ğŸ¯ Full Pipeline<br/>Maximum accuracy"]
    
    N --> P{"ğŸ’¾ Database Write<br/>SQLite operation"}
    O --> P
    P -->|Connection Error| Q["âŒ HTTP 500<br/>Database unavailable<br/>Retry logic"]
    P -->|Disk Full| R["âŒ HTTP 500<br/>Storage error<br/>Admin alert"]
    P -->|Success| S["âœ… Data Saved<br/>Return response"]
    
    T["ğŸŒ Network Issues"] --> U["â° Request Timeout<br/>Frontend handling"]
    U --> V["ğŸ”„ Retry Logic<br/>User notification"]
    
    W["ğŸ§  Model Memory<br/>Out of memory"] --> X["âš ï¸ Model Fallback<br/>Rule-based only"]
    X --> Y["ğŸ“Š Degraded Mode<br/>Notify monitoring"]
    
    style C fill:#ffebee
    style F fill:#fff8e1
    style K fill:#fff8e1
    style Q fill:#ffebee
    style S fill:#e8f5e8
                </div>
            </div>
        </div>

        <div class="diagram-section" id="performance">
            <h2>9. ğŸ“Š Performance Metrics & Analysis</h2>
            <div class="description">
                <strong>System Performance:</strong> Real-world testing results and performance characteristics.
            </div>
            
            <div class="metrics">
                <div class="metric-card">
                    <div class="metric-value">66.7%</div>
                    <div class="metric-label">Test Success Rate</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">3-5s</div>
                    <div class="metric-label">Total Response Time</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">2,725</div>
                    <div class="metric-label">Keywords Active</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">2GB</div>
                    <div class="metric-label">Model Memory Usage</div>
                </div>
            </div>
            
            <div class="diagram-container">
                <div class="mermaid">
graph LR
    A["ğŸ“Š Performance Breakdown"] --> B["ğŸ” Rule-Based<br/>&lt;50ms<br/>âœ… Fastest"]
    A --> C["ğŸ¤– Detoxify<br/>2-3 seconds<br/>âš ï¸ Bottleneck"]
    A --> D["ğŸ’° FinBERT<br/>1-2 seconds<br/>âš ï¸ Bottleneck"]
    A --> E["ğŸ’¾ Database<br/>&lt;100ms<br/>âœ… Fast"]
    
    F["ğŸ¯ Test Results"] --> G["âœ… Passed: 8/12<br/>Profanity detection<br/>Toxicity analysis"]
    F --> H["âŒ Failed: 4/12<br/>Financial fraud<br/>Death threats<br/>Phone numbers"]
    
    I["ğŸ”§ Optimization Opportunities"] --> J["âš¡ Parallel Processing<br/>Run AI models together"]
    I --> K["ğŸ§  Model Caching<br/>Pre-load at startup"]
    I --> L["ğŸ—ï¸ Async Processing<br/>Non-blocking operations"]
    I --> M["ğŸ“Š Better Keywords<br/>Financial fraud terms"]
    
    style B fill:#e8f5e8
    style C fill:#fff8e1
    style D fill:#fff8e1
    style E fill:#e8f5e8
    style G fill:#e8f5e8
    style H fill:#ffebee
                </div>
            </div>
            
            <h3>ğŸ¯ Current Test Results Analysis</h3>
            <div class="description">
                <ul>
                    <li><strong>âœ… Working Well:</strong> Profanity detection (rule-based), Toxicity detection (AI), URL/spam detection</li>
                    <li><strong>âš ï¸ Needs Improvement:</strong> Financial fraud detection, Death threat patterns, Phone number regex</li>
                    <li><strong>ğŸš€ Performance:</strong> Rule-based filtering is instantaneous, AI models are the main bottleneck</li>
                    <li><strong>ğŸ’¡ Recommendations:</strong> Enhance keywords list, adjust AI thresholds, implement parallel processing</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                htmlLabels: true,
                curve: 'basis'
            }
        });
        
        // Add smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>
</body>
</html> 